<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
</head>
<body>
<pre></pre>
<script type="text/javascript">
    // "async main"
    (async function () {
        function output(string) {
            console.log(string);
            document.getElementsByTagName("pre")[0].innerHTML += string + "<br>";
        }

        let importObject = {
            imports: {
                output,
            }
        };

        let {module, instance} = await fetch("./module.wasm")
            .then(response => response.arrayBuffer())
            .then(arrayBuffer => WebAssembly.instantiate(arrayBuffer, importObject));

        output(instance.exports.ackermann(3,4));
        output(instance.exports.get_counter())
    })();
</script>
</body>
</html>